---
article: Implementing 1D FEM
section: Initial formulation
---
<p>
  We need to solve the following <i>ordinary differential equation</i> in 1D:

  $$\begin{cases}
    - \epsilon u'' + \beta(x) u' = f(x) &amp; \text{in } [a,b] \\
    u(a) = 0 \\
    u'(b) = \gamma
  \end{cases}$$

  $$\text{with}\enspace \epsilon \gt 0,\enspace \beta: [a,b] \rarr \reals\quad \text{and}\enspace \gamma \in \reals$$
</p>

<p>
  As theory explains, we can transform this into a <i>weak form</i> by multiplying each side with a <i>test function</i> $v(x)$ and then integrate over $[a,b]$:

  $$-\epsilon \greenhl{\int_a^b u''v\;dx} + \int_a^b {\beta}u'v\;dx = \int_a^b fv\;dx$$
</p>

<p>
  The part in <span class="greenhl">green</span> can be rewritten by using <i>integration by parts</i>:

  $$\greenhl{\int_a^b u''v\;dx} = -\int_a^b u'v'\;dx + \bluehl{u'v \Big|_a^b}$$
</p>

<p>
  We can expand the <span class="bluehl">blue</span> part and simplify by substituting $u'(a) = \gamma$ and $v(a) = 0$ (choosen arbitrarily):

  $$\bluehl{u'v \Big|_a^b} = \underbrace{u'(b)}_{\gamma}\,v(b) - u'(a)\underbrace{v(a)}_{v(a) = 0} = \gamma v(b)$$

  $$\greenhl{\int_a^b u''v\;dx} = -\int_a^b u'v'\;dx + \bluehl{\gamma v(b)}$$
</p>

<p>
  Let's now replace our simplifications back into our equation in order to reach its final form:

  $$-\epsilon \bigg(\greenhl{-\int_a^b u'v'\;dx + \gamma v(b)}\bigg) + \int_a^b {\beta}u'v\;dx = \int_a^b fv\;dx$$

  $$\epsilon \int_a^b u'v'\;dx - \epsilon\gamma v(b)  + \int_a^b {\beta}u'v\;dx = \int_a^b fv\;dx$$

  $$\boxed{\epsilon \int_a^b u'v'\;dx + \int_a^b {\beta}u'v\;dx = \int_a^b fv\;dx + \epsilon\gamma v(b)}$$
</p>
